/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/cart.ts":
/*!*********************!*\
  !*** ./src/cart.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   useCart: () => (/* binding */ useCart)\n/* harmony export */ });\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n\nclass Cart {\n    constructor(items) {\n        this.items = items;\n    }\n    static formatCurrency(value) {\n        return value.toFixed(Cart.currencyDecimals) + \" kr\";\n    }\n    // Keep local storage in sync even though other tabs change it\n    static startLocalStorageSync(onSync) {\n        const onStorage = (e) => {\n            if (e.oldValue !== e.newValue) {\n                localStorage.setItem(e.key, e.newValue);\n                onSync(Cart.fromStorage());\n            }\n        };\n        // When using the back button to navigate back\n        // many browsers do not actually reload the page, but simply restore it from memory\n        // In this case we need to do some refreshing to ensure that for example the shopping cart is up to date\n        const onPageShow = (persisted) => {\n            onSync(Cart.fromStorage());\n        };\n        window.addEventListener('storage', onStorage);\n        window.addEventListener(\"pageshow\", onPageShow);\n        return () => {\n            window.removeEventListener('storage', onStorage);\n            window.removeEventListener(\"pageshow\", onPageShow);\n        };\n    }\n    setItem(productID, count) {\n        let done = false;\n        for (let i = 0; i < this.items.length; i++) {\n            if (this.items[i].id == productID) {\n                if (count == 0) {\n                    this.items.splice(i, 1);\n                }\n                else {\n                    this.items[i].count = count;\n                }\n                done = true;\n                break;\n            }\n        }\n        if (!done && count > 0) {\n            this.items.push({\n                id: productID,\n                count: count,\n            });\n        }\n    }\n    getItemCount(productID) {\n        for (let i = 0; i < this.items.length; i++) {\n            if (this.items[i].id == productID)\n                return this.items[i].count;\n        }\n        return 0;\n    }\n    sum(id2product) {\n        let totalSum = 0;\n        this.items = this.items.filter(i => id2product.get(i.id));\n        for (let item of this.items) {\n            totalSum += item.count * id2product.get(item.id).price;\n        }\n        return totalSum;\n    }\n    static adjustItemCount(count, item) {\n        if (count < 0)\n            count = 0;\n        // Note: the |0 will ensure the number is a 32-bit integer\n        return (Math.ceil(count / item.smallest_multiple) * item.smallest_multiple) | 0;\n    }\n    saveToStorage() {\n        localStorage.setItem(\"cart\", JSON.stringify(this.items));\n    }\n    static oneOfEachProduct(products) {\n        return new Cart(products.map(p => ({ id: p.id, count: 1 })));\n    }\n    static fromStorage() {\n        let cart = [];\n        try {\n            cart = JSON.parse(localStorage.getItem(\"cart\"));\n        }\n        catch (e) { }\n        if (!Array.isArray(cart)) {\n            cart = [];\n        }\n        return new Cart(cart);\n    }\n}\nCart.currency = \"kr\";\nCart.currencyDecimals = 2;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Cart);\nconst useCart = () => {\n    // Keep local storage in sync even though other tabs change it\n    const [cart, setCart] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Cart.fromStorage());\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => Cart.startLocalStorageSync(setCart));\n    return {\n        cart, setCart: (cart) => {\n            cart.saveToStorage();\n            setCart(Cart.fromStorage());\n        }\n    };\n};\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/cart.ts?");

/***/ }),

/***/ "./src/change_phone.ts":
/*!*****************************!*\
  !*** ./src/change_phone.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   show_phone_number_dialog: () => (/* binding */ show_phone_number_dialog)\n/* harmony export */ });\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common */ \"./src/common.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\nfunction show_phone_number_dialog(member_id, prompt, validate_prompt, t) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let new_number = yield prompt();\n        if (new_number === null) {\n            return \"cancel\";\n        }\n        let change_id;\n        try {\n            change_id = (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"POST\", `${window.apiBasePath}/member/send_phone_number_validation_code`, { member_id, phone: new_number.trim() })).data;\n            console.assert(typeof change_id === \"number\");\n        }\n        catch (error) {\n            if (error.status === _common__WEBPACK_IMPORTED_MODULE_0__.UNAUTHORIZED) {\n                return _common__WEBPACK_IMPORTED_MODULE_0__.UNAUTHORIZED;\n            }\n            else {\n                yield _common__WEBPACK_IMPORTED_MODULE_0__.show_error(t(\"change_phone.errors.generic\"), error);\n                return \"cancel\";\n            }\n        }\n        return yield validate_phone_number_prompt(change_id, validate_prompt, t);\n    });\n}\nfunction validate_phone_number_prompt(id, prompt, t) {\n    return __awaiter(this, void 0, void 0, function* () {\n        while (true) {\n            let validation_code = yield prompt();\n            if (validation_code === null) {\n                return \"cancel\";\n            }\n            if (isNaN(parseInt(validation_code))) {\n                yield UIkit.modal.alert(`<h2>${t(\"change_phone.errors.incorrect_code\")}</h2>`);\n            }\n            else {\n                try {\n                    yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"POST\", `${window.apiBasePath}/member/validate_phone_number`, { id, validation_code });\n                    break;\n                }\n                catch (error) {\n                    if (error.status === _common__WEBPACK_IMPORTED_MODULE_0__.UNAUTHORIZED) {\n                        return _common__WEBPACK_IMPORTED_MODULE_0__.UNAUTHORIZED;\n                    }\n                    else {\n                        yield _common__WEBPACK_IMPORTED_MODULE_0__.show_error(t(\"change_phone.errors.incorrect_code\"), error);\n                    }\n                }\n            }\n        }\n        return \"ok\";\n    });\n}\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/change_phone.ts?");

/***/ }),

/***/ "./src/common.ts":
/*!***********************!*\
  !*** ./src/common.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UNAUTHORIZED: () => (/* binding */ UNAUTHORIZED),\n/* harmony export */   addSidebarListeners: () => (/* binding */ addSidebarListeners),\n/* harmony export */   ajax: () => (/* binding */ ajax),\n/* harmony export */   documentLoaded: () => (/* binding */ documentLoaded),\n/* harmony export */   formatDate: () => (/* binding */ formatDate),\n/* harmony export */   formatDateTime: () => (/* binding */ formatDateTime),\n/* harmony export */   getValue: () => (/* binding */ getValue),\n/* harmony export */   get_error: () => (/* binding */ get_error),\n/* harmony export */   login: () => (/* binding */ login),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   onGetAndDocumentLoaded: () => (/* binding */ onGetAndDocumentLoaded),\n/* harmony export */   refreshLoggedIn: () => (/* binding */ refreshLoggedIn),\n/* harmony export */   removeToken: () => (/* binding */ removeToken),\n/* harmony export */   show_error: () => (/* binding */ show_error),\n/* harmony export */   trackPlausible: () => (/* binding */ trackPlausible),\n/* harmony export */   updateCartSum: () => (/* binding */ updateCartSum),\n/* harmony export */   uploadFile: () => (/* binding */ uploadFile)\n/* harmony export */ });\n/* harmony import */ var _cart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cart */ \"./src/cart.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\nconst UNAUTHORIZED = \"unauthorized\";\nconst trackPlausible = (...args) => {\n    if (window.plausible !== undefined) {\n        window.plausible(...args);\n    }\n    else {\n        (window.plausible.q = window.plausible.q || []).push(args);\n    }\n};\nfunction formatDate(str) {\n    const options = {\n        year: \"numeric\", month: \"numeric\", day: \"numeric\",\n        hour12: false\n    };\n    const parsed_date = Date.parse(str);\n    // If the date was parsed successfully we should update the string\n    if (!isNaN(parsed_date)) {\n        return new Intl.DateTimeFormat(\"sv-SE\", options).format(parsed_date);\n    }\n    return \"\";\n}\nfunction formatDateTime(str) {\n    const options = {\n        year: \"numeric\", month: \"numeric\", day: \"numeric\",\n        hour: \"numeric\", minute: \"numeric\", second: \"numeric\",\n        hour12: false\n    };\n    const parsed_date = Date.parse(str);\n    // If the date was parsed successfully we should update the string\n    if (!isNaN(parsed_date)) {\n        return new Intl.DateTimeFormat(\"sv-SE\", options).format(parsed_date);\n    }\n    return \"\";\n}\nfunction get_error(json) {\n    if (typeof json.message === 'string')\n        return json.message;\n    return json.status;\n}\nfunction show_error(heading, error) {\n    return __awaiter(this, void 0, void 0, function* () {\n        yield UIkit.modal.alert(\"<h2>\" + heading + \"</h2>\" + get_error(error));\n    });\n}\nfunction uploadFile(url, file) {\n    let token = localStorage.getItem(\"token\") || \"\";\n    let headers = {\n        'Authorization': \"Bearer \" + token,\n        \"Content-Type\": file.type,\n    };\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('filename', file.name);\n    return fetch(url, {\n        headers,\n        method: \"POST\",\n        body: formData,\n    }).then(response => response.json());\n}\nfunction ajax(type, url, data = null, options = {}) {\n    return new Promise((resolve, reject) => {\n        var _a;\n        const xhr = new XMLHttpRequest();\n        xhr.open(type, url);\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n        let token = (_a = options.loginToken) !== null && _a !== void 0 ? _a : localStorage.getItem(\"token\");\n        if (token) {\n            xhr.setRequestHeader('Authorization', \"Bearer \" + token);\n        }\n        xhr.onload = () => {\n            if (xhr.status >= 200 && xhr.status <= 300) {\n                resolve(JSON.parse(xhr.responseText));\n            }\n            else if (xhr.status === 401 || xhr.status === 403) {\n                removeToken();\n                reject({ status: UNAUTHORIZED, message: JSON.parse(xhr.responseText).message });\n            }\n            else\n                reject(JSON.parse(xhr.responseText));\n        };\n        xhr.onerror = () => {\n            let response;\n            try {\n                response = JSON.parse(xhr.responseText);\n            }\n            catch (err) {\n                response = \"bad json: \" + xhr.responseText;\n            }\n            reject(response);\n        };\n        if (data == null) {\n            xhr.send();\n        }\n        else {\n            xhr.send(JSON.stringify(data));\n        }\n    });\n}\nfunction documentLoaded() {\n    return new Promise((resolve) => {\n        document.addEventListener('DOMContentLoaded', () => resolve());\n    });\n}\nfunction refreshLoggedIn(callback) {\n    const apiBasePath = window.apiBasePath;\n    ajax(\"GET\", apiBasePath + \"/member/current/permissions\", null)\n        .then(json => {\n        callback(true, json.data.permissions);\n    })\n        .catch(json => {\n        if (json.status === UNAUTHORIZED) {\n            callback(false, null);\n        }\n        else {\n            UIkit.modal.alert(\"<h2>Error</h2>\" + json.status + \"\\n\" + json.message);\n        }\n    });\n}\nfunction updateCartSum(cart, id2item) {\n    const cartEmpty = cart.items.length == 0;\n    const sidebarBuyBtn = document.querySelector(\".sidebar-buy-btn\");\n    if (sidebarBuyBtn !== null) {\n        sidebarBuyBtn.classList.toggle(\"cart-empty\", cartEmpty);\n    }\n    if (cartEmpty) {\n        document.querySelectorAll(\"#cart-sum\").forEach(e => e.textContent = \"\");\n    }\n    else {\n        document.querySelectorAll(\"#cart-sum\").forEach(e => e.textContent = \" (\" + _cart__WEBPACK_IMPORTED_MODULE_0__[\"default\"].formatCurrency(cart.sum(id2item)) + \")\");\n    }\n}\nfunction getValue(selector) {\n    return document.querySelector(selector).value;\n}\nfunction onGetAndDocumentLoaded(url, callback) {\n    Promise\n        .all([\n        ajax(\"GET\", window.apiBasePath + url, {}),\n        documentLoaded()\n    ])\n        .catch(json => {\n        UIkit.modal.alert(\"<h2>Error</h2>\" + get_error(json));\n    })\n        .then((res) => {\n        const data = res[0].data;\n        callback(data);\n    });\n}\nfunction addSidebarListeners() {\n    const logoutButton = document.querySelector(\"#logout\");\n    if (logoutButton != null) {\n        logoutButton.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n            logout();\n        });\n    }\n}\nfunction removeToken() {\n    localStorage.removeItem(\"token\");\n}\nfunction logout() {\n    removeToken();\n    window.location.href = \"/\";\n}\nfunction login(token) {\n    localStorage.setItem(\"token\", token);\n}\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/common.ts?");

/***/ }),

/***/ "./src/member_common.ts":
/*!******************************!*\
  !*** ./src/member_common.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LoadCurrentAccessInfo: () => (/* binding */ LoadCurrentAccessInfo),\n/* harmony export */   LoadCurrentMemberGroups: () => (/* binding */ LoadCurrentMemberGroups),\n/* harmony export */   LoadCurrentMemberInfo: () => (/* binding */ LoadCurrentMemberInfo),\n/* harmony export */   LoadCurrentMembershipInfo: () => (/* binding */ LoadCurrentMembershipInfo)\n/* harmony export */ });\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common */ \"./src/common.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\nfunction LoadCurrentMemberInfo() {\n    return __awaiter(this, void 0, void 0, function* () {\n        return (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"GET\", window.apiBasePath + \"/member/current\", null)).data;\n    });\n}\nfunction LoadCurrentMembershipInfo() {\n    return __awaiter(this, void 0, void 0, function* () {\n        return (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"GET\", window.apiBasePath + \"/member/current/membership\", null)).data;\n    });\n}\nfunction LoadCurrentMemberGroups() {\n    return __awaiter(this, void 0, void 0, function* () {\n        return (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"GET\", `${window.apiBasePath}/member/current/groups`)).data;\n    });\n}\nfunction LoadCurrentAccessInfo() {\n    return __awaiter(this, void 0, void 0, function* () {\n        return (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax(\"GET\", window.apiBasePath + \"/member/current/access\", null)).data;\n    });\n}\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/member_common.ts?");

/***/ }),

/***/ "./src/payment_common.tsx":
/*!********************************!*\
  !*** ./src/payment_common.tsx ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AssertIsWellKnownProductId: () => (/* binding */ AssertIsWellKnownProductId),\n/* harmony export */   FindWellKnownProduct: () => (/* binding */ FindWellKnownProduct),\n/* harmony export */   LoadProductData: () => (/* binding */ LoadProductData),\n/* harmony export */   PaymentFailedError: () => (/* binding */ PaymentFailedError),\n/* harmony export */   PaymentIntentNextActionType: () => (/* binding */ PaymentIntentNextActionType),\n/* harmony export */   PaymentIntentResult: () => (/* binding */ PaymentIntentResult),\n/* harmony export */   ProductDataFromProducts: () => (/* binding */ ProductDataFromProducts),\n/* harmony export */   SetupIntentResult: () => (/* binding */ SetupIntentResult),\n/* harmony export */   StripeCardInput: () => (/* binding */ StripeCardInput),\n/* harmony export */   ToPayPreview: () => (/* binding */ ToPayPreview),\n/* harmony export */   calculateAmountToPay: () => (/* binding */ calculateAmountToPay),\n/* harmony export */   createPaymentMethod: () => (/* binding */ createPaymentMethod),\n/* harmony export */   createStripeCardInput: () => (/* binding */ createStripeCardInput),\n/* harmony export */   disable_pay_button: () => (/* binding */ disable_pay_button),\n/* harmony export */   display_stripe_error: () => (/* binding */ display_stripe_error),\n/* harmony export */   enable_pay_button: () => (/* binding */ enable_pay_button),\n/* harmony export */   extractRelevantProducts: () => (/* binding */ extractRelevantProducts),\n/* harmony export */   handleStripeSetupIntent: () => (/* binding */ handleStripeSetupIntent),\n/* harmony export */   initializeStripe: () => (/* binding */ initializeStripe),\n/* harmony export */   mountStripe: () => (/* binding */ mountStripe),\n/* harmony export */   negotiatePayment: () => (/* binding */ negotiatePayment),\n/* harmony export */   pay: () => (/* binding */ pay),\n/* harmony export */   stripe: () => (/* binding */ stripe)\n/* harmony export */ });\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./common */ \"./src/common.ts\");\n/* harmony import */ var _translations__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./translations */ \"./src/translations.tsx\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/// <reference path=\"../node_modules/@types/stripe-v3/index.d.ts\" />\n\n\n\nvar stripe;\nvar card;\nvar spinner;\nvar payButton;\nvar errorElement;\nfunction initializeStripe() {\n    // Create a Stripe client.\n    stripe = Stripe(window.stripeKey);\n}\nfunction mountStripe() {\n    // Create an instance of Elements.\n    const elements = stripe.elements({ locale: \"sv\" });\n    // Custom styling can be passed to options when creating an Element.\n    const stripeStyle = {\n        base: {\n            color: '#32325d',\n            lineHeight: '18px',\n            fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n            fontSmoothing: 'antialiased',\n            fontSize: '16px',\n            '::placeholder': {\n                color: '#aab7c4'\n            }\n        },\n        invalid: {\n            color: '#fa755a',\n            iconColor: '#fa755a'\n        }\n    };\n    // Create an instance of the card Element.\n    card = elements.create('card', { style: stripeStyle });\n    card.mount(\"#card-element\");\n    payButton = document.getElementById(\"pay-button\");\n    spinner = document.querySelector(\".progress-spinner\");\n    errorElement = document.getElementById('card-errors');\n    return card;\n}\nlet waitingForPaymentResponse = false;\nfunction enable_pay_button() {\n    spinner.classList.remove(\"progress-spinner-visible\");\n    waitingForPaymentResponse = false;\n    payButton.disabled = false;\n}\n;\nfunction disable_pay_button() {\n    payButton.disabled = true;\n    waitingForPaymentResponse = true;\n    spinner.classList.add(\"progress-spinner-visible\");\n}\n;\nfunction default_before_initiate_payment() {\n    disable_pay_button();\n    errorElement.textContent = \"\";\n}\n;\nfunction display_stripe_error(error) {\n    errorElement.textContent = error.message;\n    UIkit.modal.alert(\"<h2>Your payment failed</h2>\" + errorElement.innerHTML);\n}\nvar PaymentIntentNextActionType;\n(function (PaymentIntentNextActionType) {\n    PaymentIntentNextActionType[\"USE_STRIPE_SDK\"] = \"use_stripe_sdk\";\n})(PaymentIntentNextActionType || (PaymentIntentNextActionType = {}));\nconst WellKnownProducts = [\"access_starter_pack\", \"single_membership_year\", \"single_labaccess_month\", \"membership_subscription\", \"labaccess_subscription\"];\nfunction AssertIsWellKnownProductId(id) {\n    if (!WellKnownProducts.includes(id)) {\n        throw new Error(`Unknown product id ${id}`);\n    }\n}\nfunction FindWellKnownProduct(products, id) {\n    return products.find(p => p.product_metadata.special_product_id === id) || null;\n}\nconst calculateAmountToPay = ({ productData, cart, currentMemberships, discount }) => {\n    var _a, _b;\n    const payNow = [];\n    const payRecurring = [];\n    // Calculate which memberships the user will have after the non-subscription products have been purchased.\n    // This is important to handle e.g. purchasing the starter pack and a membership at the same time.\n    // This is because the starter pack includes makerspace acccess membership for 2 months, so the subscription will then only start\n    // after the starter pack is over, and thus the subscription will not be included in the paidRightNow output.\n    currentMemberships = [...currentMemberships];\n    const cartProducts = cart.items.map(i => productData.id2item.get(i.id));\n    if (FindWellKnownProduct(cartProducts, \"single_labaccess_month\") !== null || FindWellKnownProduct(cartProducts, \"access_starter_pack\") !== null) {\n        currentMemberships.push(\"labaccess\");\n    }\n    if (FindWellKnownProduct(cartProducts, \"single_membership_year\") !== null) {\n        currentMemberships.push(\"membership\");\n    }\n    for (const item of cart.items) {\n        const product = productData.id2item.get(item.id);\n        const subscriptionType = product.product_metadata.subscription_type;\n        if (subscriptionType !== undefined) {\n            if (item.count != product.smallest_multiple) {\n                throw new Error(`Cannot purchase ${item.count} of product ${product.name}. Expected ${product.smallest_multiple}`);\n            }\n        }\n        else if (item.count % product.smallest_multiple !== 0) {\n            throw new Error(`Cannot purchase ${item.count} of product ${product.name}. Expected a multiple of ${product.smallest_multiple}`);\n        }\n        let price = parseFloat(product.price);\n        const originalPrice = price;\n        if ((_b = (_a = product.product_metadata.allowed_price_levels) === null || _a === void 0 ? void 0 : _a.includes(discount.priceLevel)) !== null && _b !== void 0 ? _b : false) {\n            price *= 1 - discount.fractionOff;\n        }\n        if (subscriptionType === undefined || !currentMemberships.includes(subscriptionType)) {\n            // TODO: There's no support right now for displaying a different price during the binding period, if one exists\n            payNow.push({\n                product,\n                count: item.count,\n                amount: price * item.count,\n                originalAmount: originalPrice * item.count,\n            });\n        }\n        if (subscriptionType !== undefined) {\n            // The recurring price is always just a single unit of the product\n            payRecurring.push({\n                product,\n                count: 1,\n                amount: price,\n                originalAmount: originalPrice,\n            });\n        }\n    }\n    return { payNow, payRecurring };\n};\nfunction LoadProductData() {\n    return __awaiter(this, void 0, void 0, function* () {\n        const categories = (yield _common__WEBPACK_IMPORTED_MODULE_1__.ajax(\"GET\", window.apiBasePath + \"/webshop/product_data\", null)).data;\n        return ProductDataFromProducts(categories);\n    });\n}\nfunction ProductDataFromProducts(categories) {\n    const id2item = new Map();\n    const products = [];\n    for (const c of categories) {\n        for (const item of c.items) {\n            id2item.set(item.id, item);\n            products.push(item);\n        }\n    }\n    return { categories, products, id2item };\n}\nconst StripeCardInput = ({ element }) => {\n    const mountPoint = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(null);\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => {\n        element.mount(mountPoint.current);\n    }, []);\n    return (React.createElement(\"div\", { ref: mountPoint }));\n};\nconst createStripeCardInput = () => {\n    // Create an instance of Elements.\n    const elements = stripe.elements({ locale: \"sv\" });\n    // Custom styling can be passed to options when creating an Element.\n    const stripeStyle = {\n        base: {\n            color: '#32325d',\n            lineHeight: '18px',\n            fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n            fontSmoothing: 'antialiased',\n            fontSize: '16px',\n            '::placeholder': {\n                color: '#aab7c4'\n            }\n        },\n        invalid: {\n            color: '#fa755a',\n            iconColor: '#fa755a'\n        }\n    };\n    // Create an instance of the card Element.\n    return elements.create('card', { style: stripeStyle, hidePostalCode: true });\n};\nconst currencyToString = (value) => {\n    if (value - Math.abs(value) < 0.01) {\n        return value.toFixed(0);\n    }\n    else {\n        return value.toFixed(2);\n    }\n};\nconst ToPayPreview = ({ productData, cart, discount, currentMemberships }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_2__.useTranslation)();\n    const { payNow, payRecurring } = calculateAmountToPay({ productData, cart, discount, currentMemberships });\n    let renewInfoText = payRecurring.map(({ product, amount }) => {\n        const product_id = product.product_metadata.special_product_id;\n        AssertIsWellKnownProductId(product_id);\n        return t(`special_products.${product_id}.renewal`)(amount);\n    }).join(\" \");\n    if (payRecurring.length == 1) {\n        renewInfoText += \" \" + t(\"special_products.renewal.one\");\n    }\n    else if (payRecurring.length > 1) {\n        renewInfoText += \" \" + t(\"special_products.renewal.many\");\n    }\n    let anyDiscountedColumn = false;\n    const paidRightNowItems = payNow.map(({ product, amount, originalAmount }, i) => {\n        const product_id = product.product_metadata.special_product_id;\n        AssertIsWellKnownProductId(product_id);\n        if (product.unit !== \"mån\" && product.unit !== \"år\" && product.unit !== \"st\")\n            throw new Error(`Unexpected unit '${product.unit}' for ${product.name}. Expected one of år/mån/st`);\n        let period = product.smallest_multiple + \" \" + t(`unit.${product.unit}.${product.smallest_multiple > 1 ? \"many\" : \"one\"}`);\n        if (product_id === \"access_starter_pack\") {\n            // Special case for the starter pack period. Otherwise it would show \"1 st\"\n            period = t(\"special_products.access_starter_pack.period\");\n        }\n        if (amount !== originalAmount) {\n            anyDiscountedColumn = true;\n        }\n        return [t(`special_products.${product_id}.summary`) + \" - \" + period, amount, amount !== originalAmount ? originalAmount : undefined];\n    });\n    if (paidRightNowItems.length === 0) {\n        return React.createElement(React.Fragment, null,\n            React.createElement(\"span\", { className: \"small-print\" }, t(\"special_products.payment_right_now_nothing\")),\n            payRecurring.length > 0 ? (React.createElement(\"span\", { className: \"small-print\" }, renewInfoText)) : null);\n    }\n    else {\n        return (React.createElement(React.Fragment, null,\n            React.createElement(\"span\", { className: \"small-print\" }, t(\"special_products.payment_right_now\")),\n            React.createElement(\"div\", { class: \"history-item to-pay-preview\" },\n                React.createElement(\"div\", { class: \"receipt-items \" + (anyDiscountedColumn ? \"with-original-price-column\" : \"\") }, paidRightNowItems.map(([summary, price, normalPrice]) => (React.createElement(React.Fragment, null,\n                    React.createElement(\"span\", { className: \"product-title\" }, summary),\n                    normalPrice !== undefined && React.createElement(\"span\", { className: \"receipt-item-original-amount strikethrough-price\" },\n                        currencyToString(normalPrice),\n                        \" \",\n                        t(\"priceUnit\")),\n                    React.createElement(\"span\", { className: \"receipt-item-amount\" },\n                        currencyToString(price),\n                        \" \",\n                        t(\"priceUnit\")))))),\n                React.createElement(\"div\", { class: \"receipt-amount\" },\n                    React.createElement(\"span\", null, t(\"special_products.cart_total\")),\n                    React.createElement(\"span\", { className: \"receipt-amount-value\" },\n                        currencyToString(payNow.reduce((s, { amount }) => s + amount, 0)),\n                        \" \",\n                        t(\"priceUnit\")))),\n            payRecurring.length > 0 ? (React.createElement(\"span\", { className: \"small-print\" }, renewInfoText)) : null));\n    }\n};\nconst extractRelevantProducts = (products) => {\n    const starterPackProduct = FindWellKnownProduct(products, \"access_starter_pack\");\n    const baseMembershipProduct = FindWellKnownProduct(products, \"single_membership_year\");\n    const labaccessProduct = FindWellKnownProduct(products, \"single_labaccess_month\");\n    const membershipSubscriptionProduct = FindWellKnownProduct(products, \"membership_subscription\");\n    const labaccessSubscriptionProduct = FindWellKnownProduct(products, \"labaccess_subscription\");\n    if (starterPackProduct === null)\n        throw new Error(\"No starter pack product found\");\n    if (baseMembershipProduct === null)\n        throw new Error(\"No base membership product found\");\n    if (labaccessProduct === null)\n        throw new Error(\"No labaccess product found\");\n    if (membershipSubscriptionProduct === null)\n        throw new Error(\"No membership subscription product found\");\n    if (labaccessSubscriptionProduct === null)\n        throw new Error(\"No labaccess subscription product found\");\n    return {\n        starterPackProduct,\n        baseMembershipProduct,\n        labaccessProduct,\n        membershipSubscriptionProduct,\n        labaccessSubscriptionProduct,\n    };\n};\nfunction createPaymentMethod(element, memberInfo) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const result = yield stripe.createPaymentMethod('card', element, {\n            billing_details: {\n                name: `${memberInfo.firstname} ${memberInfo.lastname}`,\n                email: memberInfo.email,\n                phone: memberInfo.phone,\n                address: {\n                    postal_code: `${memberInfo.address_zipcode}`,\n                },\n            },\n        });\n        if (result.error) {\n            UIkit.modal.alert(\"<h2>Your payment failed</h2>\" + result.error.message);\n            return null;\n        }\n        console.assert(result.paymentMethod !== undefined);\n        return result.paymentMethod;\n    });\n}\nclass PaymentFailedError {\n    constructor(message) {\n        this.message = message;\n    }\n}\nvar SetupIntentResult;\n(function (SetupIntentResult) {\n    SetupIntentResult[\"Success\"] = \"success\";\n    SetupIntentResult[\"RequiresAction\"] = \"requires_action\";\n    SetupIntentResult[\"Wait\"] = \"wait\";\n    SetupIntentResult[\"Failed\"] = \"failed\";\n})(SetupIntentResult || (SetupIntentResult = {}));\nvar PaymentIntentResult;\n(function (PaymentIntentResult) {\n    PaymentIntentResult[\"Success\"] = \"success\";\n    PaymentIntentResult[\"RequiresAction\"] = \"requires_action\";\n    PaymentIntentResult[\"Wait\"] = \"wait\";\n})(PaymentIntentResult || (PaymentIntentResult = {}));\nfunction handleStripeSetupIntent(endpoint, data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        while (true) {\n            let res;\n            try {\n                res = yield _common__WEBPACK_IMPORTED_MODULE_1__.ajax(\"POST\", endpoint, data);\n            }\n            catch (e) {\n                if (e[\"message\"] !== undefined) {\n                    throw new PaymentFailedError(e[\"message\"]);\n                }\n                else {\n                    throw e;\n                }\n            }\n            data.setup_intent_id = res.data.setup_intent_id;\n            switch (res.data.type) {\n                case SetupIntentResult.Success:\n                    return res.data;\n                case SetupIntentResult.RequiresAction:\n                    if (res.data.action_info.type === PaymentIntentNextActionType.USE_STRIPE_SDK) {\n                        const stripeResult = yield stripe.confirmCardSetup(res.data.action_info.client_secret);\n                        if (stripeResult.error) {\n                            throw new PaymentFailedError(stripeResult.error.message);\n                        }\n                        else {\n                            // The card action has been handled\n                            // Now we try the server endpoint again in the next iteration of the loop\n                        }\n                    }\n                    else {\n                        throw new Error(\"Unexpected action type\");\n                    }\n                    break;\n                case SetupIntentResult.Wait:\n                    // Stripe needs some time to confirm the payment. Wait a bit and try again.\n                    yield new Promise(resolve => setTimeout(resolve, 500));\n                    break;\n                case SetupIntentResult.Failed:\n                    throw new PaymentFailedError(res.data.error);\n            }\n        }\n    });\n}\nfunction negotiatePayment(endpoint, data, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        while (true) {\n            let res;\n            try {\n                res = yield _common__WEBPACK_IMPORTED_MODULE_1__.ajax(\"POST\", endpoint, data, { loginToken: options.loginToken });\n            }\n            catch (e) {\n                if (e[\"message\"] !== undefined) {\n                    throw new PaymentFailedError(e[\"message\"]);\n                }\n                else {\n                    throw e;\n                }\n            }\n            data.transaction_id = res.data.transaction_id;\n            switch (res.data.type) {\n                case PaymentIntentResult.Success:\n                    return res.data;\n                case PaymentIntentResult.RequiresAction:\n                    if (res.data.action_info.type === PaymentIntentNextActionType.USE_STRIPE_SDK) {\n                        const stripeResult = yield stripe.handleCardAction(res.data.action_info.client_secret);\n                        if (stripeResult.error) {\n                            throw new PaymentFailedError(stripeResult.error.message);\n                        }\n                        else {\n                            // The card action has been handled\n                            // Now we try the server endpoint again in the next iteration of the loop\n                        }\n                    }\n                    else {\n                        throw new Error(\"Unexpected action type\");\n                    }\n                    break;\n                case PaymentIntentResult.Wait:\n                    // Stripe needs some time to confirm the payment. Wait a bit and try again.\n                    yield new Promise(resolve => setTimeout(resolve, 500));\n                    break;\n            }\n        }\n    });\n}\nfunction pay(paymentMethod, cart, productData, discount, currentMemberships, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { payNow, payRecurring } = calculateAmountToPay({ cart, productData, discount, currentMemberships });\n        let transaction_id = null;\n        if (payNow.length > 0) {\n            transaction_id = (yield negotiatePayment(window.apiBasePath + \"/webshop/pay\", {\n                cart: payNow.map(p => ({\n                    id: p.product.id,\n                    count: p.count,\n                })),\n                expected_sum: payNow.reduce((sum, { amount }) => sum + amount, 0),\n                stripe_payment_method_id: paymentMethod.id,\n                transaction_id: null,\n            }, { loginToken: options.loginToken })).transaction_id;\n        }\n        else {\n            // This will configure the default payment method\n            // This is necessary if the member already has membership (and thus the subscription will not start immediately),\n            // but they have not had a subscription before, so no default payment method has been configured yet.\n            yield handleStripeSetupIntent(window.apiBasePath + \"/webshop/setup_payment_method\", {\n                stripe_payment_method_id: paymentMethod.id,\n                setup_intent_id: null\n            });\n        }\n        const subscriptionStarts = payRecurring.map(({ product, amount }) => ({\n            subscription: product.product_metadata.subscription_type,\n            expected_to_pay_recurring: \"\" + amount,\n            expected_to_pay_now: \"0\", // We should already have paid for the member to be a member, so the subscription should start in the future and not charge anything right now\n        }));\n        if (subscriptionStarts.length > 0) {\n            try {\n                yield _common__WEBPACK_IMPORTED_MODULE_1__.ajax('POST', `${window.apiBasePath}/webshop/member/current/subscriptions`, {\n                    subscriptions: subscriptionStarts,\n                }, { loginToken: options.loginToken });\n            }\n            catch (e) {\n                throw new PaymentFailedError(_common__WEBPACK_IMPORTED_MODULE_1__.get_error(e));\n            }\n        }\n        return { transaction_id };\n    });\n}\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/payment_common.tsx?");

/***/ }),

/***/ "./src/translate.tsx":
/*!***************************!*\
  !*** ./src/translate.tsx ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Translation: () => (/* binding */ Translation)\n/* harmony export */ });\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n/// This file contains a bunch of hard to understand typescript types.\n/// They are used to type check the translation dictionary.\n/// The dictionary is a nested object with string keys and string/function values.\n///\n/// This file should rarely require any modifications.\n///\n/// See https://stackoverflow.com/questions/58277973/how-to-type-check-i18n-dictionaries-with-typescript\n\nclass Translation {\n    constructor(translations) {\n        this.translations = translations;\n    }\n    /// Get translation value for key\n    t(key) {\n        const parts = key.split(\".\");\n        let item = this.translations;\n        for (let i = 0; i < parts.length - 1; i++) {\n            let child = item[parts[i]];\n            if (child === null || child === undefined) {\n                throw new Error(\"Missing translation for \" + key);\n            }\n            else if (typeof child !== \"object\") {\n                throw new Error(\"Missing translation for \" + key);\n            }\n            item = child;\n        }\n        const v = item[parts[parts.length - 1]];\n        if (typeof v !== \"object\" || Array.isArray(v) || Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(v)) {\n            return v;\n        }\n        else {\n            throw new Error(\"Missing translation for \" + key + \". \" + v);\n        }\n    }\n}\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/translate.tsx?");

/***/ }),

/***/ "./src/translations.tsx":
/*!******************************!*\
  !*** ./src/translations.tsx ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TranslationContext: () => (/* binding */ TranslationContext),\n/* harmony export */   TranslationWrapper: () => (/* binding */ TranslationWrapper),\n/* harmony export */   Translations: () => (/* binding */ Translations),\n/* harmony export */   translateUnit: () => (/* binding */ translateUnit),\n/* harmony export */   useTranslation: () => (/* binding */ useTranslation)\n/* harmony export */ });\n/* harmony import */ var _translate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./translate */ \"./src/translate.tsx\");\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n/* harmony import */ var _urls__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./urls */ \"./src/urls.ts\");\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./common */ \"./src/common.ts\");\n\n\n\n\n\nconst Eng = {\n    continue: \"Continue\",\n    back: \"Back\",\n    and: \"and\",\n    cancel: \"Cancel\",\n    apply_for_discounts: \"I cannot afford the membership fee\",\n    unit: {\n        år: {\n            one: \"year\",\n            many: \"years\",\n        },\n        mån: {\n            one: \"month\",\n            many: \"months\",\n        },\n        st: {\n            one: \"piece\",\n            many: \"pieces\",\n        }\n    },\n    priceUnit: \"kr\",\n    special_products: {\n        labaccess_subscription: {\n            summary: \"Makerspace Access\",\n            renewal: (price) => `Your makerspace access will renew monthly at ${price} kr/month.`,\n        },\n        membership_subscription: {\n            summary: \"Base Membership\",\n            renewal: (price) => `Your base membership will renew yearly at ${price} kr/year.`,\n        },\n        single_labaccess_month: {\n            summary: \"Makerspace Access\",\n            renewal: (price) => { throw new Error(\"This should never be called\"); },\n        },\n        single_membership_year: {\n            summary: \"Makerspace Access\",\n            renewal: (price) => { throw new Error(\"This should never be called\"); },\n        },\n        access_starter_pack: {\n            summary: \"Starter Pack\",\n            period: \"2 months\",\n            renewal: (price) => { throw new Error(\"This should never be called\"); },\n        },\n        renewal: {\n            one: \"You can cancel this subscription at any time.\",\n            many: \"You can cancel these subscriptions at any time.\"\n        },\n        cart_total: \"Total\",\n        payment_right_now_nothing: \"Right now, you will pay nothing.\",\n        payment_right_now: \"Right now, you will pay\",\n    },\n    registration_page: {\n        memberships: {\n            title: \"Makerspace Memberships\",\n            p1: \"Memberships are split into two parts\",\n            p2: React.createElement(React.Fragment, null,\n                \"Everyone has the yearly \",\n                React.createElement(\"b\", null, \"Base Membership\"),\n                \", and if you want to work on your own projects, you must also get \",\n                React.createElement(\"b\", null, \"Makerspace Access\"),\n                \" (paid monthly).\"),\n        },\n        chooseYourPlan: {\n            title: \"Choose your membership\",\n            help: \"\"\n        },\n        plans: {\n            ofWhichBaseMembership: (price) => `of which ${price} kr is yearly base membership`,\n            makerspaceAccessSub: {\n                title: \"Makerspace Access Subscription\",\n                abovePrice: \"\",\n                period: \"per month\",\n                description1: \"A monthly subscription gets you access all the time, for a lower price.\\n2 months minimum.\",\n                description2: \"\",\n                included: [\n                    \"Take part in courses and social events\",\n                    \"Vote at yearly meetings\",\n                    \"Support your local makerspace\",\n                    \"Access to Stockholm Makerspace 24/7\",\n                    \"Work on your own projects\",\n                    \"Store a personal box at the space\"\n                ],\n                notIncluded: [],\n            },\n            starterPack: {\n                title: \"Starter Pack\",\n                abovePrice: \"\",\n                period: \"\",\n                description1: \"Two months of makerspace access for a lower price. New members only.\",\n                description2: \"\",\n                included: [\n                    \"Take part in courses and social events\",\n                    \"Vote at yearly meetings\",\n                    \"Support your local makerspace\",\n                    \"Access to Stockholm Makerspace 24/7\",\n                    \"Work on your own projects\",\n                    \"Store a personal box at the space\"\n                ],\n                notIncluded: [],\n            },\n            singleMonth: {\n                title: \"1 month of Makerspace Access\",\n                abovePrice: \"\",\n                period: \"\",\n                description1: \"One month of makerspace access.\",\n                description2: \"\",\n                included: [\n                    \"Take part in courses and social events\",\n                    \"Vote at yearly meetings\",\n                    \"Support your local makerspace\",\n                    \"Access to Stockholm Makerspace 24/7\",\n                    \"Work on your own projects\",\n                    \"Store a personal box at the space\"\n                ],\n                notIncluded: [],\n            },\n            decideLater: {\n                title: \"1 year of Base Membership only\",\n                abovePrice: \"\",\n                price: \"0\",\n                period: \"\",\n                description1: \"One year of base membership.\",\n                description2: (a, b) => `Later, you can pay for individual months of makerspace access (${a} kr/mo) in our webshop, or get a subscription (${b} kr/mo).`,\n                included: [\n                    \"Take part in courses and social events\",\n                    \"Vote at yearly meetings\",\n                    \"Support your local makerspace\",\n                ],\n                notIncluded: [\n                    \"Access to the space outside of events\",\n                    \"Work on your own projects\",\n                    \"Store a personal box at the space\",\n                ],\n            },\n        },\n        memberInfo: {\n            title: \"A little bit about you\",\n            firstName: \"First name\",\n            lastName: \"Last name\",\n            email: \"Email\",\n            phone: \"Phone (your phone will be used as your key to the makerspace)\",\n            zipCode: \"Zip code\",\n            submit: \"Continue\",\n            validatePhone: \"We have sent a validation code to your phone. Please enter it below.\",\n        },\n        terms: {\n            title: \"Rules for the premises\",\n            accept: \"Accept\",\n            pledge: \"You must pledge to ...\",\n            rules: [\n                \"take responsibility for your own actions and to show consideration for other members.\",\n                \"not do anything illegal on the premises.\",\n                \"abstain from using drugs or alcohol on the premises.\",\n                \"not operate machines while under the influence.\",\n                \"keep yourself updated on the latest rules.\",\n                \"find and follow space- and machine-specific rules.\",\n                \"always clean up after yourself and leave the premises in a clean state.\",\n                \"ask a member of the Board if you're unsure about something.\",\n                \"always ask before taking pictures of people or other people's projects located on the premises.\",\n                \"not engage in commercial activities on the premises.\",\n                \"not sleep on the premises.\",\n                \"retrieve your storage box within 45 days from expiration of your makerspace access. After this period of time, any remaining materials belong to the Stockholm Makerspace.\",\n                \"take full responsibility for what your guests do on the premises. (Your guest is only allowed on the premises if your intention is to show them the space and activities. They must not work on a project of their during their visit.)\",\n                \"always leave the kitchen/common areas in better shape than you found them. This is especially important in areas shared with other building occupants and we risk losing access to these areas if this privilege is abused.\",\n                \"report lost keys to the Board immediately after loss.\",\n                \"report damage to the machines/premises to the Board immediately upon discovery.\",\n                \"not remove equipment from the premises. Stockholm Makerspace does not allow equipment rental or borrowing.\",\n                \"only visit the space when you hold an active membership. If your makerspace access is inactive, you have no access to the premises except as participant in Makerspace run activities such as courses, cleanup days or open days.\",\n            ],\n            understanding1: \"I understand that if I violate any of the rules above or otherwise abuse my access to the premises, I may be banned from the premises without a refund of my access fee.\",\n            understanding2: \"I understand that I am solely responsible for everything I do on the premises.\",\n            welcoming: \"I will do my best to ensure that the Stockholm Makerspace is a clean, safe and welcoming place.\",\n        },\n        calendar: {\n            title: \"Calendar\",\n            text: (React.createElement(React.Fragment, null,\n                \"Book a Member Introduction, during which you'll get a tour of the space (if you haven't already) and gain permission to use the makerspace. Your makerspace access will not be activated until you have visited a Member Introduction. In some situations, there may be no available time slots. Please let us know on \",\n                React.createElement(\"a\", { href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_FACEBOOK_GROUP }, \"Facebook\"),\n                \" or \",\n                React.createElement(\"a\", { href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_SLACK_HELP }, \"Slack\"),\n                \" if you cannot book a slot.\")),\n            book_button: \"Book a member introduction\"\n        },\n        payment: {\n            title: \"Payment\",\n            text: React.createElement(React.Fragment, null,\n                React.createElement(\"p\", null, \"Almost done, we just need to take care of the payment.\"),\n                React.createElement(\"p\", null,\n                    \"Before you gain access to the makerspace you need to attend a member introduction. These are held \",\n                    React.createElement(\"a\", { target: \"_blank\", href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_CALENDAR }, \"regularly every 1-2 weeks\"),\n                    \".\")),\n            payment_processor: \"Payment handled by Stripe\",\n        },\n        success: {\n            title: \"Welcome to the Stockholm\\u{00A0}Makerspace!\",\n            text: React.createElement(React.Fragment, null,\n                React.createElement(\"p\", null, \"We look forward to meeting you!\"),\n                React.createElement(\"p\", null, \"To gain access to the Makerspace you must attend a member introduction. You can book it here, or do it later.\"),\n                React.createElement(\"p\", null, \"Here are your next steps:\")),\n            book_button: \"Book your member introduction\",\n            book_step: \"\",\n            steps: [\n                // ((onClick: (e: MouseEvent)=>void) => (<>Book a Member Introduction, during which you'll get a tour of the space (if you haven't already) and gain permission to use the makerspace. Your makerspace access will not be activated until you have visited a Member Introduction.\n                // You can find them in the calendar: https://calendly.com/medlemsintroduktion/medlemsintroduktion (\"Medlemsintroduktion\" in Swedish)</>)),\n                ((onClick) => (React.createElement(React.Fragment, null,\n                    \"Join our \",\n                    React.createElement(\"a\", { target: \"_blank\", href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_SLACK_HELP, onClick: onClick }, \"Slack\"),\n                    \" to chat with other members.\"))),\n                ((onClick) => (React.createElement(React.Fragment, null,\n                    \"Take our \",\n                    React.createElement(\"a\", { target: \"_blank\", href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_GET_STARTED_QUIZ, onClick: onClick }, \"Get Started Quiz\"),\n                    \" to learn about the space.\"))),\n                ((onClick) => (React.createElement(React.Fragment, null,\n                    \"Check out our \",\n                    React.createElement(\"a\", { target: \"_blank\", href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_WIKI, onClick: onClick }, \"wiki\"),\n                    \".\"))),\n                ((onClick) => (React.createElement(React.Fragment, null,\n                    \"Get inspired on our \",\n                    React.createElement(\"a\", { target: \"_blank\", href: _urls__WEBPACK_IMPORTED_MODULE_2__.URL_INSTAGRAM, onClick: onClick }, \"Instagram\"),\n                    \".\"))),\n            ],\n            continue_to_member_portal: \"Continue to your member page\",\n        },\n        discounts: {\n            title: \"Low Income Discounts\",\n            text: \"If you cannot afford the full price of membership, you can apply for a discount.\",\n            confirmation: (fraction) => React.createElement(React.Fragment, null,\n                React.createElement(\"p\", null, \"Discount approved!\"),\n                React.createElement(\"p\", null,\n                    \"You'll get a \",\n                    fraction * 100,\n                    \"% discount on membership.\"),\n                React.createElement(\"p\", null, \"We understand that not everyone can afford the full price of membership. But there are other ways you can help, if you want to. The Makerspace is run by its members volonteering their time and effort. Join a work day, help out with maintaining a machine, or why not hold a course about something you are excited about?\")),\n            submit: \"Continue\",\n            submit_write_more: \"Please write a bit more\",\n            cancel: \"Cancel\",\n            messagePlaceholder: \"Tell us why you need a discount, in at least a few sentences.\",\n            reasons: {\n                \"student\": \"I am a student\",\n                \"unemployed\": \"I am unemployed\",\n                \"senior\": \"I am a senior citizen\",\n                \"other\": \"Other\",\n            }\n        },\n    },\n    member_page: {\n        member: \"Member\",\n        billing: {\n            title: \"Billing\",\n            manage: \"Manage Payment Methods\",\n        },\n        old_membership_status: {\n            labaccess: {\n                inactive: \"Your makerspace access is inactive.\",\n                inactive_recent: (days) => `Your makerspace access expired ${days} days ago.`,\n                inactive_yesterday: `Your makerspace access expired yesterday`,\n                active_hours_remaining: (hours) => `Your makerspace access is valid for only ${hours} more hours.`,\n                active_few_days_remaining: (end_date, days) => `Your makerspace access is valid through ${end_date} (only ${days} days left).`,\n                active_days_remaining: (end_date, days) => `Your makerspace access is valid through ${end_date} (${days} days left).`,\n            },\n            membership: {\n                inactive: \"Your base membership is inactive.\",\n                inactive_recent: (days) => `Your base membership expired ${days} days ago.`,\n                inactive_yesterday: `Your base membership expired yesterday`,\n                active_hours_remaining: (hours) => `Your base membership is valid for only ${hours} more hours.`,\n                active_few_days_remaining: (end_date, days) => `Your base membership is valid through ${end_date} (only ${days} days left).`,\n                active_days_remaining: (end_date, days) => `Your base membership is valid through ${end_date} (${days} days left).`,\n            },\n            special_labaccess: {\n                inactive: \"Your special makerspace access is inactive.\",\n                inactive_recent: (days) => `Your special makerspace access expired ${days} days ago.`,\n                inactive_yesterday: `Your special makerspace access expired yesterday`,\n                active_hours_remaining: (hours) => `You have been given special access to the premises, which is for only ${hours} more hours.`,\n                active_few_days_remaining: (end_date, days) => `You have been given special access to the premises through ${end_date} (only ${days} days left).`,\n                active_days_remaining: (end_date, days) => `You have been given special access to the premises through ${end_date} (${days} days left).`,\n            }\n        },\n        subscriptions: {\n            cancel: {\n                membership: {\n                    valid_until: (date) => `Your base membership will stay active until it expires on ${date}.`,\n                },\n                labaccess: {\n                    valid_until: (date) => `Your makerspace access will stay active until it expires on ${date}.`,\n                }\n            },\n            descriptions: {\n                membership: \"Base membership gives you voting rights at the yearly meeting, supports your local makerspace, and allows you to attend courses/social events.\",\n                labaccess: `Makerspace access allows you to work on your own projects at the makerspace.\r\n                You get 24/7 access to the space and you can also store one box with your own things at the space.\r\n                Makerspace Access requires the Base Membership.`,\n            },\n            pending_makerspace_access: (pending_days) => React.createElement(React.Fragment, null,\n                \"Your \",\n                React.createElement(\"strong\", null, pending_days),\n                \" days of makerspace access will start when you attend a member introduction.\"),\n            add_to_cart: (count, unit, price) => `Add ${count} ${unit} to cart: ${price} kr`,\n            binding_period: (count, unit) => `subscription has a binding period of ${count} ${unit}.`,\n            next_charge: (amount, date) => `Your membership will renew at ${(0,_common__WEBPACK_IMPORTED_MODULE_3__.formatDate)(date)} for ${amount} kr.`,\n            activate_auto_renewal: (price, unit) => `Activate auto-renewal: ${price}/${unit}`,\n            auto_renewal_active: \"Auto renew: Active\",\n            errors: {\n                no_member_introduction: `\r\n                    <h2>Cannot start subscription</h2>\r\n                    <p>You must attend a member introduction before you can start an auto-renewal subscription.</p><p>You can find them in the <a href=\"${_urls__WEBPACK_IMPORTED_MODULE_2__.URL_CALENDAR}\">calendar</a>.</p>\r\n                `\n            },\n            pay_dialog: {\n                title: \"Activate auto-renewal\",\n            }\n        },\n        change_phone_number: \"Change\",\n        send_accessy_invite_msg: \"Install the Accessy app on your phone. You can use this to unlock doors at the makerspace.\",\n        send_accessy_invite: \"Send Accessy invite\",\n        change_pin_code: \"Change\",\n        instructions_to_become_member: \"Remaining steps to get makerspace access\",\n    },\n    payment: {\n        pay_with_stripe: \"Pay with Stripe\",\n    },\n    change_phone: {\n        new_number_prompt: \"New phone number\",\n        validation_code_prompt: \"Validation code: \",\n        errors: {\n            generic: \"Could not change phone number\",\n            incorrect_code: \"Incorrect code. Try again.\",\n        }\n    }\n};\nconst Swe = Object.assign(Object.assign({}, Eng), { continue: \"Fortsätt\" });\nconst Translations = {\n    \"en\": Eng,\n    \"sv\": Swe,\n};\nconst TranslationContext = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(new _translate__WEBPACK_IMPORTED_MODULE_0__.Translation(Translations.en));\nconst useTranslation = () => {\n    const t = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(TranslationContext);\n    return t.t.bind(t);\n};\nconst heuristicallyPickLanguage = () => {\n    const langs = navigator.languages || [navigator.language];\n    for (let lang of langs) {\n        lang = lang.toLowerCase();\n        if (lang.startsWith(\"sv\")) {\n            return \"sv\";\n        }\n        else if (lang.startsWith(\"en\")) {\n            return \"en\";\n        }\n    }\n    // Fall back to English\n    return \"en\";\n};\nconst TranslationWrapper = ({ children }) => {\n    const [language, setLanguage] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(heuristicallyPickLanguage());\n    const tr = new _translate__WEBPACK_IMPORTED_MODULE_0__.Translation(Translations[language]);\n    return (React.createElement(TranslationContext.Provider, { value: tr }, children));\n};\nconst translateUnit = (unit, count, t) => {\n    if (unit !== \"mån\" && unit !== \"år\" && unit !== \"st\")\n        throw new Error(`Unexpected unit '${unit}'. Expected one of år/mån/st`);\n    return t(`unit.${unit}.${count > 1 ? \"many\" : \"one\"}`);\n};\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/translations.tsx?");

/***/ }),

/***/ "./src/try.tsx":
/*!*********************!*\
  !*** ./src/try.tsx ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common */ \"./src/common.ts\");\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n/* harmony import */ var _payment_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./payment_common */ \"./src/payment_common.tsx\");\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react-calendly'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n/* harmony import */ var _urls__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./urls */ \"./src/urls.ts\");\n/* harmony import */ var _member_common__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./member_common */ \"./src/member_common.ts\");\n/* harmony import */ var _translations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./translations */ \"./src/translations.tsx\");\n/* harmony import */ var _cart__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./cart */ \"./src/cart.ts\");\n/* harmony import */ var _change_phone__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./change_phone */ \"./src/change_phone.ts\");\nObject(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\n\n\n\n\n\n\nconst FEATURE_FLAG_LOW_INCOME_DISCOUNT = false;\nconst LabeledInput = ({ label, id, required, type, value, pattern, onChange, onInvalid, placeholder }) => {\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", null,\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"label\", { for: id, class: \"uk-form-label\" }, label),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"input\", { id: id, class: \"uk-input\", type: type, pattern: pattern, placeholder: placeholder, value: value, required: required, maxLength: 255, onChange: e => onChange(e.currentTarget.value), onInvalid: onInvalid })));\n};\nconst PlanButton = ({ plan, selected, onClick, order }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"access-plan \" + (selected ? 'selected' : '') + ` semantic-order-${order}`, onClick: onClick },\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"access-plan-title\" },\n            plan.title,\n            plan.highlight !== null ? Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { class: \"plan-highlight\" },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, plan.highlight)) : null),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"access-plan-price\" },\n            plan.abovePrice && Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { class: \"abovePrice\" }, plan.abovePrice),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { class: \"price\" }, plan.price),\n            plan.belowPrice && Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { class: \"belowPrice\" }, plan.belowPrice)),\n        plan.description1 && Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"access-plan-description-top\" }, plan.description1),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"ul\", { className: \"checkmark-list\" },\n            t(`registration_page.plans.${plan.id}.included`).map((reason, i) => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"li\", { key: i },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { className: \"positive\", \"uk-icon\": \"icon: check\" }),\n                \" \",\n                reason)),\n            t(`registration_page.plans.${plan.id}.notIncluded`).map((reason, i) => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"li\", { key: i },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { className: \"negative\", \"uk-icon\": \"icon: close\" }),\n                \" \",\n                reason))),\n        plan.description2 && Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"access-plan-description-bottom\" }, plan.description2)));\n};\nconst BackButton = ({ onClick }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"a\", { className: \"flow-button-back\", onClick: onClick }, t(\"back\")));\n};\nconst validate_phone_number = (phone, t) => __awaiter(void 0, void 0, void 0, function* () {\n    const r = yield (0,_change_phone__WEBPACK_IMPORTED_MODULE_7__.show_phone_number_dialog)(null, () => __awaiter(void 0, void 0, void 0, function* () { return phone; }), () => __awaiter(void 0, void 0, void 0, function* () { return yield UIkit.modal.prompt(t(\"registration_page.memberInfo.validatePhone\")); }), t);\n    return r;\n});\nconst MemberInfoForm = ({ info, onChange, onSubmit, onBack }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    const [showErrors, setShowErrors] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(false);\n    const [inProgress, setInProgress] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(false);\n    const onInvalid = () => setShowErrors(true);\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"form\", { className: \"member-info \" + (showErrors ? \"validate\" : \"\"), onSubmit: (e) => __awaiter(void 0, void 0, void 0, function* () {\n            setInProgress(true);\n            e.preventDefault();\n            setShowErrors(false);\n            try {\n                if ((yield validate_phone_number(info.phone, t)) === \"ok\") {\n                    onSubmit(info);\n                }\n            }\n            finally {\n                setInProgress(false);\n            }\n        }), onInvalid: () => {\n            setShowErrors(true);\n        } },\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(LabeledInput, { label: t(\"registration_page.memberInfo.firstName\"), id: \"firstName\", type: \"text\", required: true, value: info.firstName, onChange: firstName => onChange(info => (Object.assign(Object.assign({}, info), { firstName }))), onInvalid: onInvalid }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(LabeledInput, { label: t(\"registration_page.memberInfo.lastName\"), id: \"lastName\", type: \"text\", required: true, value: info.lastName, onChange: lastName => onChange(info => (Object.assign(Object.assign({}, info), { lastName }))), onInvalid: onInvalid }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(LabeledInput, { label: t(\"registration_page.memberInfo.email\"), id: \"email\", type: \"email\", required: true, value: info.email, onChange: email => onChange(info => (Object.assign(Object.assign({}, info), { email }))), onInvalid: onInvalid }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(LabeledInput, { label: t(\"registration_page.memberInfo.phone\"), id: \"phone\", type: \"tel\", pattern: \"[\\\\-\\\\+\\\\s0-9]*\", required: true, value: info.phone, onChange: phone => onChange(info => (Object.assign(Object.assign({}, info), { phone }))), onInvalid: onInvalid }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(LabeledInput, { label: t(\"registration_page.memberInfo.zipCode\"), id: \"zipCode\", type: \"text\", pattern: \"[0-9\\\\s]+\", placeholder: \"XXX XX\", required: true, value: info.zipCode, onChange: zipCode => onChange(info => (Object.assign(Object.assign({}, info), { zipCode }))), onInvalid: onInvalid }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { type: \"submit\", className: \"flow-button primary\", disabled: inProgress },\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { className: \"uk-spinner uk-icon progress-spinner \" + (inProgress ? \"progress-spinner-visible\" : \"\"), \"uk-spinner\": '' }),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, t(\"registration_page.memberInfo.submit\"))),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(BackButton, { onClick: onBack })));\n};\nconst RuleCheckbox = ({ rule, value, onChange }) => {\n    const id = `${(Math.random() * 10000) | 0}`;\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"rule-checkbox\" },\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"input\", { id: id, type: \"checkbox\", checked: value, onChange: e => onChange(e.currentTarget.checked) }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"label\", { for: id }, rule)));\n};\nconst TermsAndConditions = ({ onAccept, onBack, acceptedTerms, onChangeAcceptedTerms }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"terms-and-conditions\" },\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h2\", null, t(\"registration_page.terms.title\")),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"p\", null, t(\"registration_page.terms.pledge\")),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"ol\", { className: \"rules-list\" }, t(\"registration_page.terms.rules\").map(rule => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"li\", null, rule))),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(RuleCheckbox, { rule: t(\"registration_page.terms.understanding1\"), onChange: () => onChangeAcceptedTerms(Object.assign(Object.assign({}, acceptedTerms), { accepted1: !acceptedTerms.accepted1 })), value: acceptedTerms.accepted1 }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(RuleCheckbox, { rule: t(\"registration_page.terms.understanding2\"), onChange: () => onChangeAcceptedTerms(Object.assign(Object.assign({}, acceptedTerms), { accepted2: !acceptedTerms.accepted2 })), value: acceptedTerms.accepted2 }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(RuleCheckbox, { rule: t(\"registration_page.terms.welcoming\"), onChange: () => onChangeAcceptedTerms(Object.assign(Object.assign({}, acceptedTerms), { accepted3: !acceptedTerms.accepted3 })), value: acceptedTerms.accepted3 }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", disabled: !acceptedTerms.accepted1 || !acceptedTerms.accepted2 || !acceptedTerms.accepted3, onClick: onAccept }, t(\"registration_page.terms.accept\")),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(BackButton, { onClick: onBack })));\n};\nvar State;\n(function (State) {\n    State[State[\"ChoosePlan\"] = 0] = \"ChoosePlan\";\n    State[State[\"MemberInfo\"] = 1] = \"MemberInfo\";\n    State[State[\"Terms\"] = 2] = \"Terms\";\n    State[State[\"Confirmation\"] = 3] = \"Confirmation\";\n    State[State[\"Success\"] = 4] = \"Success\";\n    State[State[\"Discounts\"] = 5] = \"Discounts\";\n})(State || (State = {}));\nconst Confirmation = ({ memberInfo, selectedPlan, productData, discount, discountInfo, card, onRegistered, onBack }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    const [inProgress, setInProgress] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(false);\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex-1\" }),\n        t(\"registration_page.payment.text\"),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex-1\" }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(_payment_common__WEBPACK_IMPORTED_MODULE_2__.ToPayPreview, { productData: productData, cart: _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"].oneOfEachProduct(selectedPlan.products), discount: discount, currentMemberships: [] }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex-1\" }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { class: \"payment-processor\" }, t(\"registration_page.payment.payment_processor\")),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(_payment_common__WEBPACK_IMPORTED_MODULE_2__.StripeCardInput, { element: card }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", disabled: inProgress, onClick: () => __awaiter(void 0, void 0, void 0, function* () {\n                setInProgress(true);\n                try {\n                    if (selectedPlan == null) {\n                        throw new Error(\"No plan selected\");\n                    }\n                    const memberInfoValidated = Object.assign(Object.assign({}, memberInfo), { zipCode: Number(memberInfo.zipCode.replace(/\\s/g, \"\")) });\n                    const paymentMethod = yield (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.createPaymentMethod)(card, {\n                        address_street: \"\",\n                        address_extra: \"\",\n                        address_zipcode: memberInfoValidated.zipCode,\n                        address_city: \"\",\n                        email: memberInfo.email,\n                        member_id: 0,\n                        member_number: 0,\n                        firstname: memberInfo.firstName,\n                        lastname: memberInfo.lastName,\n                        phone: \"\",\n                        pin_code: \"\",\n                        labaccess_agreement_at: \"\",\n                    });\n                    if (paymentMethod !== null) {\n                        try {\n                            onRegistered(yield registerMember(paymentMethod, productData, memberInfoValidated, selectedPlan, discount, discountInfo));\n                        }\n                        catch (e) {\n                            if (e instanceof _payment_common__WEBPACK_IMPORTED_MODULE_2__.PaymentFailedError) {\n                                UIkit.modal.alert(\"<h2>Payment failed</h2>\" + e.message);\n                            }\n                            else {\n                                throw e;\n                            }\n                        }\n                    }\n                }\n                finally {\n                    setInProgress(false);\n                }\n            }) },\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { className: \"uk-spinner uk-icon progress-spinner \" + (inProgress ? \"progress-spinner-visible\" : \"\"), \"uk-spinner\": '' }),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, t(\"payment.pay_with_stripe\"))),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(BackButton, { onClick: onBack }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex-1\" })));\n};\nfunction registerMember(paymentMethod, productData, memberInfo, selectedPlan, discount, discountInfo) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const data = {\n            member: memberInfo,\n            discount: discount.priceLevel !== null && discountInfo.discountReason !== null ? {\n                price_level: discount.priceLevel,\n                message: `${discountInfo.discountReason}: ${discountInfo.discountReasonMessage}`,\n            } : null,\n        };\n        // This registers the member as pending.\n        // If the payment fails, we can safely forget about the member (it will be cleaned up during the next registration attempt).\n        // If the payment succeeds, the member will be automatically activated.\n        let loginToken;\n        try {\n            loginToken = (yield _common__WEBPACK_IMPORTED_MODULE_0__.ajax('POST', `${window.apiBasePath}/webshop/register`, data)).data.token;\n        }\n        catch (e) {\n            throw new _payment_common__WEBPACK_IMPORTED_MODULE_2__.PaymentFailedError(_common__WEBPACK_IMPORTED_MODULE_0__.get_error(e));\n        }\n        const cart = new _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"](selectedPlan.products.map(p => ({\n            id: p.id,\n            count: 1\n        })));\n        yield (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.pay)(paymentMethod, cart, productData, discount, [], { loginToken });\n        return { loginToken };\n    });\n}\nconst CheckIcon = ({ done }) => {\n    return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", { className: \"uk-icon-small uk-icon task \" + (done ? \"task-done\" : \"\"), \"uk-icon\": \"icon: check\" });\n};\nconst Success = ({ member }) => {\n    const [isBookModalOpen, setBookModalOpen] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(false);\n    const [booked, setBooked] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(false);\n    const [clickedSteps, setClickedSteps] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(new Set());\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react-calendly'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())({\n        onEventScheduled: () => {\n            setBooked(true);\n        }\n    });\n    return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h1\", null, t(\"registration_page.success.title\")),\n        t(\"registration_page.success.text\"),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"ul\", { className: \"registration-task-list\" },\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"li\", null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(CheckIcon, { done: booked }),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex uk-flex-column\" },\n                    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, t(\"registration_page.success.book_step\")),\n                    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary flow-button-small\", onClick: () => setBookModalOpen(true) }, t(\"registration_page.success.book_button\")))),\n            t(\"registration_page.success.steps\").map((step, i) => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"li\", { key: i },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(CheckIcon, { done: clickedSteps.has(i) }),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, step((e) => setClickedSteps(new Set(clickedSteps).add(i))))))),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"uk-flex-1\" }),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"a\", { href: _urls__WEBPACK_IMPORTED_MODULE_3__.URL_RELATIVE_MEMBER_PORTAL, className: \"flow-button primary\" }, t(\"registration_page.success.continue_to_member_portal\")),\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react-calendly'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), { url: \"https://calendly.com/medlemsintroduktion/medlemsintroduktion\", rootElement: document.getElementById(\"root\"), open: isBookModalOpen, onModalClose: () => setBookModalOpen(false), prefill: {\n                name: member.firstname + \" \" + member.lastname,\n                firstName: member.firstname,\n                lastName: member.lastname,\n                email: member.email,\n            } })));\n};\nconst Discounts = ({ discounts, setDiscounts, onSubmit, onCancel, discountAmounts }) => {\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    const reasons = [\"student\", \"unemployed\", \"senior\", \"other\"];\n    const [step, setStep] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(0);\n    const MIN_DISCOUNT_REASON_LENGTH = 30;\n    if (step == 0) {\n        return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h2\", null, t(\"registration_page.discounts.title\")),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"p\", null, t(\"registration_page.discounts.text\")),\n            reasons.map(reason => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"rule-checkbox\" },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"input\", { id: `reason.${reason}`, type: \"radio\", checked: discounts.discountReason === reason, onChange: (e) => setDiscounts(Object.assign(Object.assign({}, discounts), { discountReason: e.currentTarget.checked ? reason : null })) }),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"label\", { for: `reason.${reason}` }, t(`registration_page.discounts.reasons.${reason}`)))),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"textarea\", { placeholder: t(\"registration_page.discounts.messagePlaceholder\"), value: discounts.discountReasonMessage, onChange: (e) => setDiscounts(Object.assign(Object.assign({}, discounts), { discountReasonMessage: e.currentTarget.value })) }),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", onClick: () => setStep(1), disabled: discounts.discountReason === null || discounts.discountReasonMessage.length < MIN_DISCOUNT_REASON_LENGTH }, discounts.discountReason !== null && discounts.discountReasonMessage.length < MIN_DISCOUNT_REASON_LENGTH ? t(\"registration_page.discounts.submit_write_more\") : t(\"registration_page.discounts.submit\")),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", onClick: () => {\n                    setDiscounts({ discountReason: null, discountReasonMessage: \"\" });\n                    onCancel();\n                } }, t(\"registration_page.discounts.cancel\")));\n    }\n    else {\n        return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h2\", null, t(\"registration_page.discounts.title\")),\n            t(\"registration_page.discounts.confirmation\")(discountAmounts[\"low_income_discount\"]),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", onClick: onSubmit }, t(\"registration_page.discounts.submit\")),\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", onClick: () => {\n                    setDiscounts({ discountReason: null, discountReasonMessage: \"\" });\n                    onCancel();\n                } }, t(\"registration_page.discounts.cancel\")));\n    }\n};\nconst MakerspaceLogo = () => {\n    return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"img\", { src: window.staticBasePath + \"/images/logo-transparent-500px-300x210.png\", alt: \"Makerspace Logo\", className: \"registration-logo\" });\n};\nconst poorMansHistoryManager = (state, defaultState, setState, parse, toString) => {\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => {\n        history.replaceState({\n            state\n        }, \"\");\n        const listener = (e) => {\n            let newState = defaultState;\n            if (location.hash.startsWith(\"#\")) {\n                const st = parse(location.hash.slice(1));\n                if (st !== undefined)\n                    newState = st;\n            }\n            setState(newState);\n        };\n        window.addEventListener(\"popstate\", listener);\n        return () => window.removeEventListener(\"popstate\", listener);\n    }, []);\n    return (newState) => {\n        history.pushState({}, \"\", \"#\" + toString(newState));\n        setState(newState);\n    };\n};\n/// Used to get a somewhat statistically independenent number from the same seed\nfunction hash(x) {\n    x = Math.imul(((x >> 16) ^ x), 0x45d9f3b);\n    x = Math.imul(((x >> 16) ^ x), 0x45d9f3b);\n    x = (x >> 16) ^ x;\n    return x;\n}\n/// Returns what options should be visible to the user depending on a random seed.\n/// This method should be deterministic given the seed.\nconst abStateFromSeed = (seed) => {\n    return {\n        oldpage: false,\n        registration_base_membership_type: seed % 2 === 0 ? \"oneyear\" : \"subscription\",\n        registration_base_membership_only_plan_enabled: hash(seed) % 3 !== 0, // 2/3 of users will see the base membership only plan\n        price_grouping: (hash(seed + 1) % 2) === 0 ? \"separate\" : \"combined\", // 1/2 of users will see the base membership price separately like \"200 + 375 kr\", instead of combined like \"575 kr\"\n    };\n};\nconst RegisterPage = ({}) => {\n    const abState = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => {\n        var _a;\n        let seed = parseInt((_a = localStorage.getItem(\"abTestSeed\")) !== null && _a !== void 0 ? _a : \"\");\n        if (!isFinite(seed))\n            seed = (Math.random() * 1000000) | 0;\n        localStorage.setItem(\"abTestSeed\", seed.toString());\n        return abStateFromSeed(seed);\n    }, []);\n    const [state, setStateInternal] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(State.ChoosePlan);\n    const setStateHistory = poorMansHistoryManager(state, State.ChoosePlan, setStateInternal, s => State[s], s => State[s]);\n    const setState = (s) => {\n        setStateHistory(s);\n        (0,_common__WEBPACK_IMPORTED_MODULE_0__.trackPlausible)(`register/${State[s]}`, { props: abState });\n    };\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => {\n        (0,_common__WEBPACK_IMPORTED_MODULE_0__.trackPlausible)(`register/${State[state]}`, { props: abState });\n    }, []);\n    const [selectedPlan, setSelectedPlan] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"starterPack\");\n    const [memberInfo, setMemberInfo] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())({\n        firstName: \"\",\n        lastName: \"\",\n        email: \"\",\n        phone: \"\",\n        zipCode: \"\",\n    });\n    const [acceptedTerms, setAcceptedTerms] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())({\n        accepted1: false,\n        accepted2: false,\n        accepted3: false\n    });\n    const [loggedInMember, setLoggedInMember] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(null);\n    const t = (0,_translations__WEBPACK_IMPORTED_MODULE_5__.useTranslation)();\n    const card = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.createStripeCardInput)(), []);\n    const [registerPageData, setRegisterPageData] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(null);\n    const [discounts, setDiscounts] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())({\n        discountReason: null,\n        discountReasonMessage: \"\",\n    });\n    const [productData, setProductData] = Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(null);\n    Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact/hooks'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(() => {\n        _common__WEBPACK_IMPORTED_MODULE_0__.ajax('GET', `${window.apiBasePath}/webshop/register_page_data`).then(x => {\n            setRegisterPageData(x.data);\n            setProductData((0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.ProductDataFromProducts)(x.data.productData));\n        });\n    }, []);\n    if (registerPageData === null || productData === null) {\n        return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", null, \"Loading...\");\n    }\n    const priceLevel = discounts.discountReason !== null ? \"low_income_discount\" : \"normal\";\n    const discount = {\n        priceLevel,\n        fractionOff: registerPageData.discounts[priceLevel],\n    };\n    const relevantProducts = (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.extractRelevantProducts)(productData.products);\n    const accessCostSingle = parseFloat(relevantProducts.labaccessProduct.price) * (1 - discount.fractionOff);\n    const accessSubscriptionCost = parseFloat(relevantProducts.labaccessSubscriptionProduct.price) * (1 - discount.fractionOff);\n    const membershipProduct = abState.registration_base_membership_type === \"subscription\" ? relevantProducts.membershipSubscriptionProduct : relevantProducts.baseMembershipProduct;\n    const baseMembershipCost = parseFloat(membershipProduct.price) * (1 - discount.fractionOff);\n    const plans = [\n        {\n            id: \"starterPack\",\n            title: t(\"registration_page.plans.starterPack.title\"),\n            abovePrice: t(\"registration_page.plans.starterPack.abovePrice\"),\n            price: \"\",\n            belowPrice: t(\"registration_page.plans.ofWhichBaseMembership\")(baseMembershipCost),\n            description1: t(\"registration_page.plans.starterPack.description1\"),\n            description2: t(\"registration_page.plans.starterPack.description2\"),\n            products: [relevantProducts.starterPackProduct, membershipProduct],\n            highlight: \"Recommended\",\n        },\n        {\n            id: \"singleMonth\",\n            title: t(\"registration_page.plans.singleMonth.title\"),\n            abovePrice: t(\"registration_page.plans.singleMonth.abovePrice\"),\n            price: \"\",\n            belowPrice: t(\"registration_page.plans.ofWhichBaseMembership\")(baseMembershipCost),\n            description1: t(\"registration_page.plans.singleMonth.description1\"),\n            description2: t(\"registration_page.plans.singleMonth.description2\"),\n            products: [relevantProducts.labaccessProduct, membershipProduct],\n            highlight: null,\n        },\n    ];\n    if (abState.registration_base_membership_only_plan_enabled) {\n        plans.push({\n            id: \"decideLater\",\n            title: t(\"registration_page.plans.decideLater.title\"),\n            abovePrice: t(\"registration_page.plans.decideLater.abovePrice\"),\n            price: \"\",\n            belowPrice: \"\",\n            description1: t(\"registration_page.plans.decideLater.description1\"),\n            description2: t(\"registration_page.plans.decideLater.description2\")(accessCostSingle, accessSubscriptionCost),\n            products: [membershipProduct],\n            highlight: null,\n        });\n    }\n    for (const plan of plans) {\n        if (abState.price_grouping === \"separate\") {\n            const membershipProducts = plan.products.filter(p => p === membershipProduct);\n            const nonMembershipProducts = plan.products.filter(p => p !== membershipProduct);\n            const toPay1 = (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.calculateAmountToPay)({ productData, cart: _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"].oneOfEachProduct(membershipProducts), discount: discount, currentMemberships: [] });\n            const toPay2 = (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.calculateAmountToPay)({ productData, cart: _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"].oneOfEachProduct(nonMembershipProducts), discount: discount, currentMemberships: [] });\n            const toPaySum1 = toPay1.payNow.reduce((a, b) => a + b.amount, 0);\n            const toPaySum2 = toPay2.payNow.reduce((a, b) => a + b.amount, 0);\n            if (toPaySum1 === 0 || toPaySum2 === 0) {\n                plan.price = (toPaySum1 + toPaySum2) + \" \" + t(\"priceUnit\");\n            }\n            else {\n                plan.price = toPaySum1 + \" + \" + toPaySum2 + \" \" + t(\"priceUnit\");\n            }\n        }\n        else {\n            const toPay = (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.calculateAmountToPay)({ productData, cart: _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"].oneOfEachProduct(plan.products), discount: discount, currentMemberships: [] });\n            plan.price = toPay.payNow.reduce((a, b) => a + b.amount, 0) + \" \" + t(\"priceUnit\");\n        }\n    }\n    const activePlan = plans.find(plan => plan.id === selectedPlan);\n    switch (state) {\n        case State.ChoosePlan:\n            return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h1\", null, t(\"registration_page.memberships.title\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"p\", null, t(\"registration_page.memberships.p1\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"p\", null, t(\"registration_page.memberships.p2\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h2\", null, t(\"registration_page.chooseYourPlan.title\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"span\", null, t(\"registration_page.chooseYourPlan.help\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { class: \"plan-buttons\" }, plans.map((plan, i) => Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(PlanButton, { selected: selectedPlan === plan.id, onClick: () => setSelectedPlan(plan.id), plan: plan, order: i }))),\n                FEATURE_FLAG_LOW_INCOME_DISCOUNT && registerPageData.discounts[\"low_income_discount\"] > 0 && Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button\", onClick: () => setState(State.Discounts) }, t(\"apply_for_discounts\")),\n                activePlan !== undefined ? Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(_payment_common__WEBPACK_IMPORTED_MODULE_2__.ToPayPreview, { productData: productData, cart: _cart__WEBPACK_IMPORTED_MODULE_6__[\"default\"].oneOfEachProduct(activePlan.products), discount: discount, currentMemberships: [] }) : null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"button\", { className: \"flow-button primary\", disabled: selectedPlan == null, onClick: () => setState(State.MemberInfo) }, t(\"continue\"))));\n        case State.MemberInfo:\n            return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"h2\", null, t(\"registration_page.memberInfo.title\")),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MemberInfoForm, { info: memberInfo, onChange: setMemberInfo, onSubmit: (_) => setState(State.Terms), onBack: () => history.back() })));\n        case State.Terms:\n            return (Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(TermsAndConditions, { onAccept: () => setState(State.Confirmation), onBack: () => history.back(), acceptedTerms: acceptedTerms, onChangeAcceptedTerms: setAcceptedTerms })));\n        case State.Confirmation:\n            if (activePlan === undefined) {\n                // This should never happen during a normal flow, but could happen if the user does weird history manipulation\n                setState(State.ChoosePlan);\n                return null;\n            }\n            return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Confirmation, { card: card, selectedPlan: activePlan, memberInfo: memberInfo, productData: productData, discount: discount, discountInfo: discounts, onRegistered: (r) => __awaiter(void 0, void 0, void 0, function* () {\n                        _common__WEBPACK_IMPORTED_MODULE_0__.login(r.loginToken);\n                        setLoggedInMember(yield (0,_member_common__WEBPACK_IMPORTED_MODULE_4__.LoadCurrentMemberInfo)());\n                        setState(State.Success);\n                    }), onBack: () => history.back() }));\n        case State.Success:\n            if (loggedInMember === null) {\n                // This should never happen during a normal flow, but could happen if the user does weird history manipulation\n                setState(State.ChoosePlan);\n                return null;\n            }\n            return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Success, { member: loggedInMember }));\n        case State.Discounts:\n            return Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()), null,\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(MakerspaceLogo, null),\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Discounts, { discounts: discounts, setDiscounts: setDiscounts, discountAmounts: registerPageData.discounts, onSubmit: () => {\n                        setState(State.ChoosePlan);\n                    }, onCancel: () => history.back() }));\n    }\n};\n_common__WEBPACK_IMPORTED_MODULE_0__.documentLoaded().then(() => {\n    const root = document.getElementById('root');\n    (0,_payment_common__WEBPACK_IMPORTED_MODULE_2__.initializeStripe)();\n    if (root != null) {\n        Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'preact'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(_translations__WEBPACK_IMPORTED_MODULE_5__.TranslationWrapper, null,\n            Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(\"div\", { className: \"content-wrapper\" },\n                Object(function webpackMissingModule() { var e = new Error(\"Cannot find module 'react'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())(RegisterPage, null))), root);\n    }\n});\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/try.tsx?");

/***/ }),

/***/ "./src/urls.ts":
/*!*********************!*\
  !*** ./src/urls.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   URL_CALENDAR: () => (/* binding */ URL_CALENDAR),\n/* harmony export */   URL_FACEBOOK_GROUP: () => (/* binding */ URL_FACEBOOK_GROUP),\n/* harmony export */   URL_GET_STARTED_QUIZ: () => (/* binding */ URL_GET_STARTED_QUIZ),\n/* harmony export */   URL_INSTAGRAM: () => (/* binding */ URL_INSTAGRAM),\n/* harmony export */   URL_MEMBERBOOTH: () => (/* binding */ URL_MEMBERBOOTH),\n/* harmony export */   URL_RELATIVE_MEMBER_PORTAL: () => (/* binding */ URL_RELATIVE_MEMBER_PORTAL),\n/* harmony export */   URL_SLACK_HELP: () => (/* binding */ URL_SLACK_HELP),\n/* harmony export */   URL_WIKI: () => (/* binding */ URL_WIKI)\n/* harmony export */ });\nconst URL_FACEBOOK_GROUP = \"https://www.facebook.com/groups/makerspace.se\";\nconst URL_SLACK_HELP = \"https://wiki.makerspace.se/Slack\";\nconst URL_WIKI = \"https://wiki.makerspace.se\";\nconst URL_GET_STARTED_QUIZ = \"https://medlem.makerspace.se/member/quiz/1\";\nconst URL_INSTAGRAM = \"https://www.instagram.com/stockholmmakerspace/\";\nconst URL_RELATIVE_MEMBER_PORTAL = \"/member\";\nconst URL_CALENDAR = \"https://www.makerspace.se/kalendarium\";\nconst URL_MEMBERBOOTH = \"https://wiki.makerspace.se/Memberbooth\";\n\n\n//# sourceURL=webpack://webpack-and-typescript/./src/urls.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/try.tsx");
/******/ 	
/******/ })()
;